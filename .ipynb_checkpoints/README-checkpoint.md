Optimizing Patient Scheduling Using Reinforcement Learning: Prioritizing Urgent Cases

Project Description

This project implements a Reinforcement Learning (RL) agent to optimize patient scheduling in a hospital environment.
The agent learns to assign doctors to patients of different priority levels, Red (urgent) and Yellow (non-urgent), prioritizing red patients while maximizing overall efficiency and minimizing waiting times.

The project includes:

RL training using a DQN agent

Inference via a FastAPI endpoint

Real-time monitoring to track model performance, action distribution, and waiting time trends

```
RL_Project_New/   <-- root directory
│
├── env/                     # Custom environment code
│   └── hospital_env.py
│
├── models/                  # Saved RL models
│   └── dqn_hospital_sb3.zip
│
├── training/                # RL training and evaluation scripts
│   ├── train_dqn_sb3.py
│   ├── evaluate.py
│   ├── Evaluation_results.ipynb
│   └── convergence_speed.py
│
├── API/                     # API inference code
│   ├── serve_api.py
│   └── __init__.py
│
├── monitoring.py            # Real-time monitoring script
├── monitoring.log           # Monitoring log (generated by monitoring.py)
├── training_metrics.json    # Metrics from training (for drift detection)
├── api_logs.json            # Logs of API predictions (for monitoring)
├── presentation/            # Project presentation slides (PDF)
├── requirements.txt         # Python dependencies
├── README.md                # Project overview and instructions
└── Dockerfile               # Docker setup (if applicable)

```
Installation

Clone the repository:

git clone https://github.com/prudenceletaru-wq/RL_Project_New
cd RL_Project_New


Create and activate a Conda environment:

conda create -n rl_env python=3.12
conda activate rl_env


Install required packages:

pip install -r requirements.txt

Training the RL Agent

Run the training script to train the DQN agent:

python training/train_dqn.py


The trained model will be saved in the models/ folder.

Running the API Locally

Start the FastAPI server to serve the trained model:

python API/serve_api.py


Default URL: http://127.0.0.1:8000/docs

API endpoint: /predict

Input: Dictionary of current hospital state

example:

{
  "state": {
    "free_doctors": 2,
    "longest_wait_red": 8,
    "longest_wait_yellow": 12,
    "red_queue_length": 4,
    "yellow_queue_length": 5,
    "doctor1_busy_time": 0,
    "doctor2_busy_time": 0,
    "doctor3_busy_time": 2
  }
}



Example Request (Python):

import requests

state_dict = {
    "free_doctors": 2,
    "longest_wait_red": 8,
    "longest_wait_yellow": 12,
    "red_queue_length": 4,
    "yellow_queue_length": 5,
    "doctor1_busy_time": 0,
    "doctor2_busy_time": 0,
    "doctor3_busy_time": 2
}

response = requests.post(
    "http://127.0.0.1:8000/predict",
    json={"state": state_dict}
)

print(response.json())


Example Response:

{
  "action": "Serve Red",
  "reward": 76,
  "wait_time": 8,
  "free_doctors": 2
}


Action meanings:

action	meaning
"Serve Red"	Serve a Red (urgent) patient
"Serve Yellow"	Serve a Yellow (non-urgent) patient

Web-based Testing

Deployed on Render:

Interactive API docs: 

https://rl-hospital-api.onrender.com/docs

Click on /predict

Click Try it out

Enter a JSON dictionary for state (like the example below)

{
  "state": {
    "free_doctors": 2,
    "longest_wait_red": 8,
    "longest_wait_yellow": 12,
    "red_queue_length": 4,
    "yellow_queue_length": 5,
    "doctor1_busy_time": 0,
    "doctor2_busy_time": 0,
    "doctor3_busy_time": 2
  }
}

Click Execute to see the predicted action

Example Request (Python) Using the Render URL instead of localhost

import requests

state_dict = {
    "free_doctors": 2,
    "longest_wait_red": 8,
    "longest_wait_yellow": 12,
    "red_queue_length": 4,
    "yellow_queue_length": 5,
    "doctor1_busy_time": 0,
    "doctor2_busy_time": 0,
    "doctor3_busy_time": 2
}

url = "https://rl-hospital-api.onrender.com/predict"

response = requests.post(url, json={"state": state_dict})

print(response.json())


Monitoring

The system includes real-time monitoring via monitoring.py:

Reads API predictions from api_logs.json in real time

Tracks:

Recent actions: distribution of red vs yellow patients served

Recent rewards: agent’s immediate performance feedback

Recent wait times: for Red and Yellow queues

Detects:

Model drift: if action distribution deviates significantly from training distribution

Data drift: if waiting time distributions differ significantly from training

Logs warnings and summaries to monitoring.log

Running monitoring:

python monitoring.py


Deployment

This project uses Docker for deployment.

Steps to deploy on Render:

Push the repository to GitHub

Connect the repository to Render

Configure as a Docker Web Service

Render automatically builds and deploys the container

Dependencies

Key libraries (also listed in requirements.txt):

numpy

gymnasium

stable-baselines3

torch

matplotlib

fastapi

pydantic

uvicorn

scipy

Presentation/ folder: Contains the final project slides (PDF) summarizing the project workflow, RL model, evaluation results, and deployment details.